[English](README.md "null") | [فارسی](docs/README_FA.md "null")

# Ubuntu DNS Manager - ابزار پیشرفته مدیریت DNS اوبونتو

`Ubuntu DNS Manager` یک رابط کاربری گرافیکی (GUI) مبتنی بر Tkinter برای مدیریت، تست سرعت، و اعمال سرورهای DNS در سیستم‌عامل اوبونتو (و توزیع‌های مبتنی بر Debian/Ubuntu که از `nmcli` استفاده می‌کنند) است. این ابزار به کاربران اجازه می‌دهد لیست‌های DNS خارجی را Import کرده، عملکرد (پینگ و سرعت Dig) سرورها را اندازه‌گیری کنند و سرورهای کند یا نامعتبر را به صورت خودکار حذف نمایند.

**توجه:** این برنامه برای اعمال تنظیمات شبکه نیاز به دسترسی **روت (sudo)** دارد.

## ویژگی‌های کلیدی

- **پشتیبانی کامل از IPv4 و IPv6:** قابلیت Import، تست و اعمال هر دو نوع آدرس IP.
    
- **تست عملکرد:** اندازه‌گیری دقیق تاخیر (پینگ) و سرعت پاسخ‌دهی DNS (Dig).
    
- **حذف آنی (Fail-Fast Auto-Clean):** سرورهای DNS که در لحظه تست، پینگ یا سرعت پاسخ‌دهی‌شان از حد مجاز تعیین‌شده تجاوز کند، بلافاصله از لیست حذف می‌شوند.
    
- **مدیریت لیست DNS:** وارد کردن لیست‌های جدید از طریق URLهای پویا (Dynamic URLs).
    
- **سورتینگ پیشرفته:** مرتب‌سازی جدول بر اساس نام، IP، پینگ، و سرعت (با قابلیت مدیریت مقادیر غیرعددی و Sorting عددی صحیح).
    
- **پشتیبانی چندزبانه:** شامل زبان فارسی، انگلیسی، چینی و روسی.
    
- **اعمال ساده تنظیمات:** اعمال DNS دلخواه تنها با یک کلیک از طریق ابزار `nmcli`.
    

## ساختار پروژه

|فایل/دایرکتوری|توضیحات|
|---|---|
|`src/main.py`|نقطه ورود اصلی برنامه.|
|`src/gui.py`|هسته رابط کاربری (Tkinter)، مدیریت تعاملات کاربر، سورتینگ و نمایش داده‌ها.|
|`src/backend.py`|هسته منطق برنامه، شامل توابع تست (Ping/Dig)، اعتبارسنجی IP (IPv4/IPv6)، و مدیریت `nmcli`.|
|`src/config.py`|مدیریت ذخیره‌سازی و بارگذاری تنظیمات کاربر (مانند زبان، لینک‌های آپدیت و محدودیت‌های حذف خودکار).|
|`src/lang.py`|فایل ترجمه حاوی متون چندزبانه.|
|`install.sh`|اسکریپت نصب و آماده‌سازی سیستم برای وابستگی‌ها و ایجاد میانبر.|
|`README.md`|همین فایل.|

## راهنمای نصب و اجرا (Manual)

1. **نصب وابستگی‌های سیستمی:**
    
    ```
    sudo apt update
    sudo apt install python3-tk bind9-dnsutils iputils-ping curl python3-pip fonts-noto-core
    ```
    
2. **نصب کتابخانه‌های پایتون (برای فارسی‌سازی):**
    
    ```
    pip3 install arabic-reshaper python-bidi
    ```
    
    _اگر با خطا مواجه شدید، از پرچم `--break-system-packages` استفاده کنید._
    
3. **اجرا:**
    
    ```
    sudo python3 src/main.py
    ```
    

**توصیه می‌شود برای نصب آسان و کامل، اسکریپت `install.sh` را اجرا کنید.**


# src/ - هسته منطقی برنامه

دایرکتوری `src/` حاوی تمام فایل‌های منبع پایتون است که منطق و رابط کاربری `Ubuntu DNS Manager` را تشکیل می‌دهند.

## خلاصه فایل‌ها

### `main.py`

این فایل به عنوان نقطه شروع برنامه عمل می‌کند. وظیفه آن صرفاً وارد کردن ماژول‌های لازم، تنظیم محیط اولیه، و فراخوانی کلاس اصلی رابط کاربری (`DNSApp`) است.

### `gui.py`

کلاس اصلی رابط کاربری (`DNSApp` و `ConfigDialog`) در این فایل تعریف شده است.

- **وظایف اصلی:** ایجاد پنجره‌ها و ویجت‌های Tkinter، مدیریت تعاملات کاربر (کلیک دکمه‌ها، انتخاب سطرها)، اجرای منطق سورتینگ (بر اساس مقادیر عددی و متنی)، و نمایش وضعیت شبکه.
    
- **توجه ویژه:** منطق **حذف آنی (Fail-Fast)** در متد `_test_worker` پیاده‌سازی شده است، به طوری که اگر یک DNS در حین تست پینگ یا Dig از حدود تعیین‌شده در تنظیمات تجاوز کند، از طریق متد `_delete_row_safe` بلافاصله از لیست حذف می‌شود.
    

### `backend.py`

این فایل حاوی تمام منطق‌های پشت پرده و ارتباط با سیستم عامل است.

- **DNS List Management:** توابع `load_dns_list` و `save_dns_list` برای نگهداری داده‌ها در یک فایل JSON در دیسک.
    
- **IP Validation:** استفاده از کتابخانه `ipaddress` برای اعتبارسنجی و تفکیک آدرس‌های **IPv4 و IPv6**.
    
- **Network Control:** توابع `get_active_connection`, `set_dns`, و `clear_dns` برای برقراری ارتباط با `nmcli` و اعمال تنظیمات DNS.
    
- **Benchmarking:** توابع `measure_ping` (که برای IPv6 از `ping6` استفاده می‌کند) و `measure_dig_speed` برای اندازه‌گیری عملکرد.
    

### `config.py`

مدیریت تنظیمات ذخیره‌شده توسط کاربر. شامل:

- زبان رابط کاربری.
    
- لیست URLهای پویا برای Import کردن DNSها.
    
- حدود مجاز پینگ و سرعت Dig برای منطق حذف خودکار.
    

### `lang.py`

یک دیکشنری ساده برای مدیریت رشته‌های متنی چندزبانه و ارائه ترجمه برای رابط کاربری.